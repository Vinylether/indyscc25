exouser@ece-gpu-testing:~/tmp/hicma-x-dev/build$ ./tests/testing_potrf_tlr --N 40960 --NB 2048 --fixedacc 1e-8 --maxrank 130 --kind_of_problem 2 --verbose 1 --adaptive_decision 0 --adaptive_memory 1 --kind_of_cholesky 5 --gpus 1 --band_dense_dp 1000
Process grid set to 1 X 1
#XXXXX the matrix size (M) is not set! Automatically set to N.
#XXXXX the matrix size (K) is not set! Automatically set to N.
Set band_size_dense_sp = band_size_dense
Set band_size_dense_hp = band_size_dense
Tile size is very important to performance, especially for Low-rank. Make sure to tune the tile size for performance!!!
1776: Band distribution is different from band dense
1791: Set band_size_dense_dp, band_size_dense_sp, band_size_dense, and band_size_low_rank_dp to NT
1830: flops in not gathered on GPU
band_size_dense= 20 or band_size_dist= -1 is bigger than P= 1 so set distribution to 2DBCDD instead of band distribution by -d 0
#+++++ cores detected       : 8
#+++++ nodes x cores + gpu  : 1 x 8 + 1 (8+1)
#+++++ P x Q                : 1 x 1 (1/1)
#+++++ M x N                : 40960 x 40960
#+++++ MB x NB              : 2048 x 2048
#+++++ HMB x HNB            : 300 x 300
GPU MEMORY: FREE 0.450232 GB ; TOTAL 10.733093 GB

Device 0: GRID A100X-10C
Compute capability: 8.0
Update nb_gpus from input 1 to real 1
Set lookahead to 1 = 1 X 1
[   0] TIME(s)      0.01141 : PaRSEC initialized

M=40960 N=40960 NB=2048 NB=2048 HNB=300 HNB=300
nodes=1 P=1 Q=1 cores=8 nb_gpus= 1 gpu_type= 2 verbose= 1
kind_of_problem=2 st-2d-sqexp
fixedacc=1.0e-08 add_diag=0 fixed_rk=0 wave_k=50
send_full_tile=0 lookahead= 1 adaptive_decision= 0 adaptive_memory= 1
band_size_dist= 0 band_size_dense_dp:20 band_size_dense_sp:20 band_size_dense_hp: 20 band_size_dense: 20 band_size_low_rank_dp:20 NT= 20 band_p= 1
band_size_auto_tuning_termination= 0.666667 band_size_dense_gpu_memory_max= 20 exe_file_path= 
max_rank=130 gen=130 comp=130
auto_band=0 sparse=0 kind_of_cholesky=5 tensor_gemm=11 datatype_convert=0 left_looking=0
time_slots=1 sigma=1.000000 beta=0.100000 nu=0.500000 beta_time=1.000000 nu_time=0.500000 nonsep_param=0.500000 noise= 0.100000
numobj/L= 0 gpu_rows= 1 gpu_cols= 1

2075: Dense diagonal, U, V, rank Matrices are allocated
[****] TIME(s)      0.21752 : hicma_parsec_init
Generating test matrix...
Not GENERATE_RANDOM_DATA and allocate in DP
[****] TIME(s)      7.48418 : Matrix generation	band_size_norm=   1 norm_global= 6.028521e+03
Analyzing matrix structure before factorization...
[****] TIME(s)      0.00142 : Gather rank after matrix compression	min= 2147483647 max= 0 avg= 0.000000
[****] TIME(s)      0.00000 : Band_size auto-tuning	band_size_dense= 20 band_size_dist= 0 band_size_auto_tuning_termination= 0.666667
[****] TIME(s)      0.00000 : Memory for matrix allocatiion	actual= 12.500000 GB maxrank= 12.500000 GB
[****] TIME(s)      0.00000 : Matrix analysis	sparse= 0 band_size_dist= 0 WORKLOAD_BALANCE= 1
nb_dense_dp= 210 nb_dense_sp= 0 nb_dense_hp= 0 nb_dense_fp8= 0 nb_low_rank_dp= 0 nb_low_rank_sp= 0
[****] TIME(s)      0.00129 : Decision update: 0
Convert DP to SP and reallocate in SP
[****] TIME(s)      0.00063 : Convert D2S
[****] TIME(s)      0.00000 : Warmup
Running Cholesky decomposition 1 times...
DENSE_MP_GPU Start
In potrf, k 0, 0.00 % is finished; time: 0.007680 of estimated total 0.007680
In potrf, k 19, 95.00 % is finished; time: 1.868387 of estimated total 1.868387
[****] TIME(s)      1.87394 : hicma_parsec_cholesky	band_size_dense= 20 band_size_dist= 0 lookahead= 1 kind_of_problem= 2 HNB= 300 PxQ=   1 1   nb_gpus= 1 NB= 2048 N=   40960 kind_of_cholesky= 5 sparse= 0 left_looking= 0 nb_dense_dp= 210 nb_dense_sp= 0 nb_dense_hp= 0 nb_dense_fp8= 0 nb_low_rank_dp= 0 nb_low_rank_sp= 0:   12224.160262 gflops

R-LO 40960 40960 2048 2048   300 300   1 1 1 8 20 0   2 st-2d-sqexp 1.0e-08 0 0 50   0 20 0 1 0 0  130 130 130   6028.520742 140732948543544 0 176   0 1.000000 1.000000 1.000000  0.000000 133098555501568   0 2147483647 0   0 0 0   0 0 0   0 2147483647 0   0 0 0   0 0 0   12.500000 12.500000   0.000000 0.119824 0.137289 0.015119    7.484179 1.873939 0.000003 0.000004 0.000000 0.000000    0.000000e+00 1.330986e+14 1.330985e+14 2.000000e+00 9.223372e+18 1.000000 0.000000 5  1 20 20 20 11 0 0.666667    20 20 20    210 0 0 0 0 0   5 0 1 0    1 1.000000 0.100000 0.500000 1.000000 0.500000 0.500000 0.100000    0.000000e+00 0 2 0.000000e+00 6.028521e-05 6.575942e-310 0.000000e+00 0.000000 7.703235 0.000000 0  -244845936 1813984656 30989 6.57594e-310 0  GITHASH:N/A    "./tests/testing_potrf_tlr --N 40960 --NB 2048 --fixedacc 1e-8 --maxrank 130 --kind_of_problem 2 --verbose 1 --adaptive_decision 0 --adaptive_memory 1 --kind_of_cholesky 5 --gpus 1 --band_dense_dp 1000 "
Analyzing matrix after factorization...
Do not convert into DP if not checking result, because memory are allocated adaptively based on each tile
[****] TIME(s)      0.00001 : Convert S2D
[****] TIME(s)      0.00041 : Gather rank after Cholesky	min= 2147483647 max= 0 avg= 0.000000
[****] TIME(s)      0.00001 : Operation_counts : total= 0.000000e+00 op_band= 0.000000e+00 op_offband= 0.000000e+00 ratio_band= -nan op_critical_path= 0.000000e+00 op_off_critical_path= 0.000000e+00 ratio_critical_path= -nan Total_critical_path_time 0.272232, potrf 0.119824, trsm 0.137289, syrk 0.015119
N= 40960 NB= 2048 D= 2 input_accuracy= 1.000000e-08 result_accuracy= 0.000000e+00 log_det_dp= 6.5759423475331724e-310 log_det_mp= 0.0000000000000000e+00 |log_det_dp-log_det_mp|/|log_det_dp|= 1.000000e+00 ||A-A'||= 0.000000e+00 <= tol*||A||= 6.028521e-05
Cholesky decomposition testing completed successfully.

R-LO 40960 40960 2048 2048   300 300   1 1 1 8 20 0   2 st-2d-sqexp 1.0e-08 0 0 50   0 20 0 1 0 0  130 130 130   6028.520742 140732948543544 0 176   0 1.000000 1.000000 1.000000  0.000000 133098528218944   0 2147483647 0   0 0 0   0 2147483647 0   0 2147483647 0   0 0 0   0 2147483647 0   12.500000 12.500000   0.272232 0.119824 0.137289 0.015119    7.484179 1.873939 0.000003 0.000004 0.000000 0.000000    0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 -nan -nan 5  1 20 20 20 11 0 0.666667    20 20 20    210 0 0 0 0 0   5 0 1 0    1 1.000000 0.100000 0.500000 1.000000 0.500000 0.500000 0.100000    0.000000e+00 0 2 0.000000e+00 6.028521e-05 6.575942e-310 0.000000e+00 0.000000 7.703235 0.000000 0  -244845936 1813984656 30989 6.57594e-310 0  GITHASH:N/A    "./tests/testing_potrf_tlr --N 40960 --NB 2048 --fixedacc 1e-8 --maxrank 130 --kind_of_problem 2 --verbose 1 --adaptive_decision 0 --adaptive_memory 1 --kind_of_cholesky 5 --gpus 1 --band_dense_dp 1000 "
